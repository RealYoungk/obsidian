---
tags:
  - ëŒ€ì‹œë³´ë“œ
  - ì£¼ê°€
---

# ğŸ“Š ì£¼ê°€ ëŒ€ì‹œë³´ë“œ

## ğŸ”„ ìµœì‹  ìŠ¤ëƒ…ìƒ·

```dataview
TABLE WITHOUT ID
  file.link AS "ìŠ¤ëƒ…ìƒ·",
  created AS "ìƒì„±ì‹œê°"
FROM "0. ëŒ€ì‹œë³´ë“œ/ì£¼ê°€ìŠ¤ëƒ…ìƒ·"
WHERE type = "stock-snapshot"
SORT created DESC
LIMIT 1
```

## ğŸ“ˆ ì „ì²´ ê¸°ì—… í˜„í™©

```dataviewjs
// ìµœì‹  ìŠ¤ëƒ…ìƒ· íŒŒì¼ ì°¾ê¸°
const snapshots = dv.pages('"0. ëŒ€ì‹œë³´ë“œ/ì£¼ê°€ìŠ¤ëƒ…ìƒ·"')
    .where(p => p.type === "stock-snapshot")
    .sort(p => p.created, 'desc');

const latestSnapshot = snapshots.length > 0 ? snapshots[0] : null;
let currentPrices = {};

// ìµœì‹  ìŠ¤ëƒ…ìƒ·ì—ì„œ í˜„ì¬ê°€ì™€ ì‹œê°€ì´ì•¡ ì¶”ì¶œ
let currentMarketCaps = {};
if (latestSnapshot) {
    console.log("ìŠ¤ëƒ…ìƒ· íŒŒì¼:", latestSnapshot.file.path);
    const content = await app.vault.read(app.vault.getAbstractFileByPath(latestSnapshot.file.path));
    console.log("íŒŒì¼ ë‚´ìš© ê¸¸ì´:", content.length);
    
    // í˜„ì¬ê°€ ì¶”ì¶œ (í•œêµ­ ì£¼ì‹: â‚©, ë¯¸êµ­ ì£¼ì‹: $)
    const priceRegexKR = /\*\*ì¢…ëª©ì½”ë“œ\*\*:\s*(\d+)[\s\S]*?\*\*í˜„ì¬ê°€\*\*:\s*â‚©([\d,]+)/g;
    const priceRegexUS = /\*\*ì¢…ëª©ì½”ë“œ\*\*:\s*([A-Z]+)[\s\S]*?\*\*í˜„ì¬ê°€\*\*:\s*\$([\d,.]+)/g;
    
    let match;
    
    // í•œêµ­ ì£¼ì‹ ì¶”ì¶œ
    while ((match = priceRegexKR.exec(content)) !== null) {
        const ticker = match[1];
        const price = parseInt(match[2].replace(/,/g, ''));
        currentPrices[ticker] = price;
        console.log(`ì¶”ì¶œ (KR): ${ticker} = â‚©${price}`);
    }
    
    // ë¯¸êµ­ ì£¼ì‹ ì¶”ì¶œ
    while ((match = priceRegexUS.exec(content)) !== null) {
        const ticker = match[1];
        const price = parseFloat(match[2].replace(/,/g, ''));
        currentPrices[ticker] = price;
        console.log(`ì¶”ì¶œ (US): ${ticker} = $${price}`);
    }
    
    // ì‹œê°€ì´ì•¡ ì¶”ì¶œ
    const marketCapRegex = /\*\*ì¢…ëª©ì½”ë“œ\*\*:\s*([A-Z0-9]+)[\s\S]*?\*\*ì‹œê°€ì´ì•¡\*\*:\s*([^\n]+)/g;
    while ((match = marketCapRegex.exec(content)) !== null) {
        const ticker = match[1];
        const marketCap = match[2].trim();
        currentMarketCaps[ticker] = marketCap;
        console.log(`ì‹œì´: ${ticker} = ${marketCap}`);
    }
    
    console.log("ì „ì²´ ì¶”ì¶œëœ ë°ì´í„°:", {prices: currentPrices, marketCaps: currentMarketCaps});
}

// ê¸°ì—… ë¶„ì„ í˜ì´ì§€ë“¤ (templates í´ë” ì œì™¸)
const companies = dv.pages('#ê¸°ì—…ë¶„ì„')
    .where(p => !p.file.path.includes('templates'))
    .sort(p => p.ticker);

// í…Œì´ë¸” í—¤ë”
const headers = ["ê¸°ì—…ëª…", "ì¢…ëª©ì½”ë“œ", "í˜„ì¬ê°€", "í˜„ì¬ì‹œì´", "ëª©í‘œì‹œì´", "ëª©í‘œì‹œì ", "ìƒìŠ¹ì—¬ë ¥"];

// í…Œì´ë¸” ë°ì´í„° ìƒì„±
const tableData = companies.map(company => {
    const ticker = company.ticker || "N/A";
    const currentPrice = currentPrices[ticker];
    const targetMarketCap = company.ëª©í‘œì‹œê°€ì´ì•¡;
    const targetYear = company.ëª©í‘œì‹œì ;
    const market = company.market || "KQ"; // ê¸°ë³¸ê°’ ì½”ìŠ¤ë‹¥
    
    // ìƒìŠ¹ì—¬ë ¥ ê³„ì‚°
    let upside = "N/A";
    
    const currentMarketCapStr = currentMarketCaps[ticker];
    
    if (targetMarketCap && currentMarketCapStr && currentMarketCapStr !== "N/A") {
        // ëª©í‘œ ì‹œê°€ì´ì•¡ì„ ì¡° ë‹¨ìœ„ë¡œ ë³€í™˜
        let targetTrillionWon = 0;
        const targetStr = targetMarketCap.toString();
        
        if (targetStr.includes("ì¡°")) {
            const targetMatch = targetStr.match(/(\d+(?:\.\d+)?)\s*ì¡°/);
            if (targetMatch) targetTrillionWon = parseFloat(targetMatch[1]);
        } else if (targetStr.includes("ì²œì–µ")) {
            const targetMatch = targetStr.match(/(\d+)\s*ì²œì–µ/);
            if (targetMatch) targetTrillionWon = parseFloat(targetMatch[1]) / 10;
        } else if (targetStr.includes("ì–µ")) {
            const targetMatch = targetStr.match(/(\d+)\s*ì–µ/);
            if (targetMatch) targetTrillionWon = parseFloat(targetMatch[1]) / 10000;
        }
        
        // í˜„ì¬ ì‹œê°€ì´ì•¡ì„ ì¡° ë‹¨ìœ„ë¡œ ë³€í™˜
        let currentTrillionWon = 0;
        if (currentMarketCapStr.includes("ì¡°")) {
            const currentMatch = currentMarketCapStr.match(/(\d+(?:\.\d+)?)\s*ì¡°/);
            if (currentMatch) currentTrillionWon = parseFloat(currentMatch[1]);
        } else if (currentMarketCapStr.includes("ì²œì–µ")) {
            const currentMatch = currentMarketCapStr.match(/(\d+)\s*ì²œì–µ/);
            if (currentMatch) currentTrillionWon = parseFloat(currentMatch[1]) / 10;
        } else if (currentMarketCapStr.includes("ì–µ")) {
            const currentMatch = currentMarketCapStr.match(/(\d+)\s*ì–µ/);
            if (currentMatch) currentTrillionWon = parseFloat(currentMatch[1]) / 10000;
        }
        
        if (targetTrillionWon > 0 && currentTrillionWon > 0) {
            upside = ((targetTrillionWon / currentTrillionWon - 1) * 100).toFixed(0);
            
            if (parseFloat(upside) > 0) {
                upside = "+" + upside + "% ğŸ“ˆ";
            } else if (parseFloat(upside) < 0) {
                upside = upside + "% ğŸ“‰";
            } else {
                upside = "0% â–";
            }
        }
    }
    
    // í™˜ìœ¨ ì„¤ì • (ë‹¬ëŸ¬ë‹¹ ì›)
    const exchangeRate = 1330;
    
    // í˜„ì¬ê°€ í¬ë§·íŒ… (í†µí™”ë³„)
    let formattedPrice = "N/A";
    if (currentPrice) {
        if (market === "US") {
            // ë¯¸êµ­ ì£¼ì‹: ë‹¬ëŸ¬ + ì›í™” ë³‘ê¸°
            const dollarPrice = currentPrice < 10 ? currentPrice.toFixed(2) : currentPrice.toLocaleString();
            const wonPrice = Math.round(currentPrice * exchangeRate).toLocaleString();
            formattedPrice = `$${dollarPrice} (â‚©${wonPrice})`;
        } else {
            // í•œêµ­ ì£¼ì‹: ì›ìœ¼ë¡œ í‘œì‹œ
            formattedPrice = "â‚©" + Math.round(currentPrice).toLocaleString();
        }
    }
    
    return [
        company.file.name.replace(".md", ""),
        ticker,
        formattedPrice,
        currentMarketCapStr || "N/A",
        targetMarketCap || "N/A",
        targetYear || "N/A",
        upside
    ];
});

// í…Œì´ë¸” ë Œë”ë§
dv.table(headers, tableData);

// ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ ì‹œê°„ í‘œì‹œ ë° ë””ë²„ê¹… ì •ë³´
if (latestSnapshot) {
    dv.paragraph(`ğŸ“… ì£¼ê°€ ì—…ë°ì´íŠ¸: ${latestSnapshot.created}`);
    dv.paragraph(`ğŸ’¾ ìŠ¤ëƒ…ìƒ· íŒŒì¼: ${latestSnapshot.file.name}`);
    dv.paragraph(`ğŸ” ì¶”ì¶œëœ ì£¼ê°€: ${Object.keys(currentPrices).length}ê°œ ì¢…ëª©`);
}
```

## ğŸ“… ìŠ¤ëƒ…ìƒ· íˆìŠ¤í† ë¦¬

```dataview
TABLE WITHOUT ID
  file.link AS "ìŠ¤ëƒ…ìƒ·",
  created AS "ìƒì„±ì‹œê°"
FROM "0. ëŒ€ì‹œë³´ë“œ/ì£¼ê°€ìŠ¤ëƒ…ìƒ·"
WHERE type = "stock-snapshot"
SORT created DESC
LIMIT 10
```

## ğŸš€ ì£¼ê°€ ìŠ¤ëƒ…ìƒ· ìƒì„±

### Shell Commands í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ ì‹¤í–‰
1. **ëª…ë ¹ íŒ”ë ˆíŠ¸** (Cmd+P) ì—´ê¸°
2. **"Shell commands: ğŸ“Š ì£¼ê°€ ìŠ¤ëƒ…ìƒ· ìƒì„±"** ì‹¤í–‰
3. ë˜ëŠ” ì„¤ì •í•œ **ë‹¨ì¶•í‚¤** ì‚¬ìš©

### ì„¤ì • ë°©ë²•
- [[ì£¼ê°€ ìŠ¤ëƒ…ìƒ· ì„¤ì • ê°€ì´ë“œ]] ì°¸ê³ 

## ğŸ“ ë©”ëª¨
- ì£¼ê°€ ë°ì´í„°: Yahoo Finance API ì‹¤ì‹œê°„ ì¡°íšŒ
- í•œêµ­ ì£¼ì‹: .KS(ì½”ìŠ¤í”¼), .KQ(ì½”ìŠ¤ë‹¥)
- ìŠ¤ëƒ…ìƒ· ì €ì¥: `0. ëŒ€ì‹œë³´ë“œ/ì£¼ê°€ìŠ¤ëƒ…ìƒ·/`
- ìƒìŠ¹ì—¬ë ¥: ëª©í‘œ ë°¸ë¥˜ì—ì´ì…˜ ëŒ€ë¹„ í˜„ì¬ ì‹œê°€ì´ì•¡ ê³„ì‚°